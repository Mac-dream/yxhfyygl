<!-- 后台文件 admin.html -->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>后台管理系统</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 1200px; margin: 20px auto; padding: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .login-form { max-width: 300px; margin: 100px auto; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div id="loginForm" class="login-form">
        <h2>后台登录</h2>
        <input type="password" id="password" placeholder="输入密码" style="width: 100%; margin-bottom: 10px;">
        <button onclick="checkPassword()" style="width: 100%;">登录</button>
    </div>

    <div id="adminPanel" class="hidden">
        <h2>预约管理</h2>
        <button onclick="loadReservations()">刷新</button>
        <table id="reservationTable">
            <thead>
                <tr>
                    <th>预约号</th>
                    <th>姓名</th>
                    <th>联系方式</th>
                    <th>日期</th>
                    <th>时间</th>
                    <th>状态</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <script>
        function formatTime(startTime) {
            const [hour, minute] = startTime.split(':').map(Number);
            let endHour = hour;
            let endMinute = minute + 15;
            if (endMinute >= 60) {
                endHour += 1;
                endMinute -= 60;
            }
            return `${startTime}-${endHour.toString().padStart(2, '0')}:${endMinute.toString().padStart(2, '0')}`;
        }

        function checkPassword() {
            if (document.getElementById('password').value === 'qyjk123') {
                document.getElementById('loginForm').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                loadReservations();
            } else {
                alert('密码错误！');
            }
        }

        function loadReservations() {
            const reservations = JSON.parse(localStorage.getItem('reservations')) || [];
            const tbody = document.querySelector('#reservationTable tbody');
            tbody.innerHTML = '';

            reservations.forEach((res, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${res.number}</td>
                    <td>${res.name}</td>
                    <td>${res.phone}</td>
                    <td>${res.date}</td>
                    <td>${formatTime(res.time)}</td>
                    <td>
                        <select onchange="updateStatus(${index}, this.value)">
                            <option ${res.status === '未使用' ? 'selected' : ''}>未使用</option>
                            <option ${res.status === '已使用' ? 'selected' : ''}>已使用</option>
                        </select>
                    </td>
                    <td><button onclick="deleteReservation(${index})">删除</button></td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateStatus(index, newStatus) {
            let reservations = JSON.parse(localStorage.getItem('reservations'));
            reservations[index].status = newStatus;
            localStorage.setItem('reservations', JSON.stringify(reservations));
        }

        function deleteReservation(index) {
            let reservations = JSON.parse(localStorage.getItem('reservations'));
            reservations.splice(index, 1);
            localStorage.setItem('reservations', JSON.stringify(reservations));
            loadReservations();
        }
    </script>
</body>
</html>
 
